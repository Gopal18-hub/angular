<div class="flex justify-between submodule-wrapper" items-center>
  <div class="global-search submodule-wrapper-left flex items-center">
    <div class="mx-4 home-icon cursor-pointer" (click)="goToHome()">
      <svg
        width="60"
        height="60"
        viewBox="0 0 60 60"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <g filter="url(#filter0_d_2_1168)">
          <path
            d="M17 3H43C45.9174 3 48.7153 4.15893 50.7782 6.22183C52.8411 8.28473 54 11.0826 54 14V40C54 42.9174 52.8411 45.7153 50.7782 47.7782C48.7153 49.8411 45.9174 51 43 51H17C14.0826 51 11.2847 49.8411 9.22183 47.7782C7.15893 45.7153 6 42.9174 6 40L6 14C6 11.0826 7.15893 8.28473 9.22183 6.22183C11.2847 4.15893 14.0826 3 17 3V3Z"
            fill="url(#paint0_linear_2_1168)"
          />
          <path
            d="M17 3.5C11.2103 3.5 6.5 8.21028 6.5 14V40C6.5 45.7897 11.2103 50.5 17 50.5H43C48.7897 50.5 53.5 45.7897 53.5 40V14C53.5 8.21028 48.7897 3.5 43 3.5H17ZM17 3H43C49.0751 3 54 7.92487 54 14V40C54 46.0751 49.0751 51 43 51H17C10.9249 51 6 46.0751 6 40V14C6 7.92487 10.9249 3 17 3Z"
            fill="white"
            fill-opacity="0.3"
          />
        </g>
        <path
          d="M41.0106 40.8302H19.2767C18.2839 40.8302 17.4763 40.0225 17.4763 39.0298V23.7776V22.5276H16.2263H15.5348C15.4768 22.5276 15.3227 22.5276 15.2687 22.3226C15.2147 22.1175 15.3488 22.0416 15.3993 22.013L29.8176 13.8518C29.8589 13.8284 29.9057 13.816 29.953 13.816C30.0003 13.816 30.0471 13.8284 30.0883 13.8517L35.8194 17.0957L37.6851 18.1518V16.0079V15.1964C37.7215 15.166 37.8121 15.1138 37.9602 15.1138H41.0106C41.1589 15.1138 41.2496 15.1661 41.286 15.1964V19.4612V20.19L41.9203 20.549L44.5067 22.013C44.5571 22.0415 44.6912 22.1175 44.6372 22.3226C44.5832 22.5276 44.429 22.5276 44.3709 22.5276H44.061H42.811V23.7776V39.0298C42.811 40.0225 42.0034 40.8302 41.0106 40.8302Z"
          fill="#004084"
        />
        <path
          d="M41.0106 39.5802C41.3141 39.5802 41.561 39.3333 41.561 39.0298V21.782L40.036 20.9188V16.3638H38.9351V20.2957L29.953 15.2115L18.7262 21.5662V39.0298C18.7262 39.3333 18.9732 39.5802 19.2767 39.5802H41.0106ZM41.0106 42.0802H19.2767C17.5921 42.0802 16.2262 40.7144 16.2262 39.0298V23.7776H15.5348C13.9675 23.7776 13.4195 21.6973 14.7836 20.9252L29.2018 12.764C29.6678 12.5001 30.2382 12.5001 30.7042 12.764L36.4351 16.0079V15.1438C36.4351 14.4369 37.118 13.8638 37.9602 13.8638H41.0106C41.8531 13.8638 42.536 14.4369 42.536 15.1438V19.4612L45.1225 20.9252C46.4862 21.6973 45.9385 23.7776 44.3709 23.7776H44.061V39.0298C44.061 40.7144 42.6952 42.0802 41.0106 42.0802Z"
          fill="#004084"
        />
        <path
          d="M36.096 29.725V30.533C36.096 30.7983 35.9906 31.0526 35.8031 31.2401C35.6156 31.4277 35.3612 31.533 35.096 31.533H24.81C24.5448 31.533 24.2904 31.4277 24.1029 31.2401C23.9154 31.0526 23.81 30.7983 23.81 30.533V29.725C23.81 29.4598 23.9154 29.2055 24.1029 29.0179C24.2904 28.8304 24.5448 28.725 24.81 28.725H35.096C35.3612 28.725 35.6156 28.8304 35.8031 29.0179C35.9906 29.2055 36.096 29.4598 36.096 29.725Z"
          fill="white"
          stroke="white"
        />
        <path
          d="M30.357 36.272H29.549C29.2838 36.272 29.0294 36.1667 28.8419 35.9791C28.6544 35.7916 28.549 35.5372 28.549 35.272V24.986C28.549 24.7208 28.6544 24.4665 28.8419 24.2789C29.0294 24.0914 29.2838 23.986 29.549 23.986H30.357C30.6222 23.986 30.8766 24.0914 31.0641 24.2789C31.2516 24.4665 31.357 24.7208 31.357 24.986V35.272C31.357 35.5372 31.2516 35.7916 31.0641 35.9791C30.8766 36.1667 30.6222 36.272 30.357 36.272Z"
          fill="white"
          stroke="white"
        />
        <defs>
          <filter
            id="filter0_d_2_1168"
            x="0"
            y="0"
            width="60"
            height="60"
            filterUnits="userSpaceOnUse"
            color-interpolation-filters="sRGB"
          >
            <feFlood flood-opacity="0" result="BackgroundImageFix" />
            <feColorMatrix
              in="SourceAlpha"
              type="matrix"
              values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
              result="hardAlpha"
            />
            <feOffset dy="3" />
            <feGaussianBlur stdDeviation="3" />
            <feColorMatrix
              type="matrix"
              values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.161 0"
            />
            <feBlend
              mode="normal"
              in2="BackgroundImageFix"
              result="effect1_dropShadow_2_1168"
            />
            <feBlend
              mode="normal"
              in="SourceGraphic"
              in2="effect1_dropShadow_2_1168"
              result="shape"
            />
          </filter>
          <linearGradient
            id="paint0_linear_2_1168"
            x1="30"
            y1="3"
            x2="30"
            y2="51"
            gradientUnits="userSpaceOnUse"
          >
            <stop stop-color="white" stop-opacity="0.788" />
            <stop offset="1" stop-color="white" stop-opacity="0.259" />
          </linearGradient>
        </defs>
      </svg>
    </div>
    <form class="w-full" autocomplete="off">
      <mat-form-field appearance="outline" class="shadow-1">
        <input
          matInput
          placeholder="Search for Max id/ First name/ Last name/ Phone/ DOB/health/aa"
          #searchVal
          (keydown.enter)="applyFilter(searchVal.value)"
        />
        <span matPrefix class="flex mr-3"
          ><mat-icon>search</mat-icon>
          <span class="border-right border-width-1 ml-1"></span>
        </span>
        <span
          matSuffix
          class="cursor-pointer search-pointer-trigger"
          (click)="menuTrigger.openMenu()"
        >
          <span
            #menuTrigger="matMenuTrigger"
            [matMenuTriggerFor]="gloablSearch"
          ></span>
          <svg
            width="20"
            height="19"
            viewBox="0 0 20 19"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M17.627 3.50998H14.054"
              stroke="#5A5A5A"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M11.394 1.12799V5.89099"
              stroke="#5A5A5A"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M14.287 3.50998H1.18701"
              stroke="#5A5A5A"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M5.95001 9.479H1.18701"
              stroke="#5A5A5A"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M8.61002 7.09698V11.86"
              stroke="#5A5A5A"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M18.818 9.479H5.71802"
              stroke="#5A5A5A"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M17.627 15.448H14.054"
              stroke="#5A5A5A"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M11.394 13.067V17.83"
              stroke="#5A5A5A"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M14.287 15.448H1.18701"
              stroke="#5A5A5A"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </span>
      </mat-form-field>
    </form>
    <mat-menu
      #gloablSearch="matMenu"
      class="search-header-menu"
      xPosition="before"
    >
      <form
        (ngSubmit)="searchSubmit()"
        [formGroup]="searchForm"
        class="mx-6 my-2"
      >
        <div
          class="flex justify-between flex-wrap"
          (click)="$event.stopPropagation()"
          (keydown)="$event.stopPropagation()"
        >
          <div
            *ngFor="let question of questions; let i = index"
            class="w-1/45 mb-3"
          >
            <maxhealth-question
              [question]="question"
              [form]="searchForm"
              [questions]="questions"
              [index]="i"
            ></maxhealth-question>
          </div>
        </div>
        <div
          class="flex flex-row-reverse mt-1 search-note"
          *ngIf="
            activePageItem?.globalSearchKey == 'global' ||
            activePageItem?.globalSearchKey == 'merge'
          "
        >
          **Please enter Name / Phone in combination with DOB as search criteria
        </div>
        <div class="flex flex-row-reverse mt-1">
          <button
            mat-raised-button
            color="primary"
            class="w-1/3 float-right mt-2"
            type="submit"
          >
            Search <mat-icon>east</mat-icon>
          </button>
        </div>
      </form>
    </mat-menu>
  </div>
  <div class="submodule-wrapper-right" *ngIf="submodules?.length > 0">
    <ul class="flex flex-row list-unstyled">
      <ng-container *ngFor="let module of submodules">
        <ng-container *ngIf="module.moreOptions">
          <li
            [matMenuTriggerFor]="menu"
            #subMenuTrigger="matMenuTrigger"
            class="mr-2 cursor-pointer max-health-primary-color"
            [matMenuTriggerData]="{
              module: module,
              subMenuTrigger: subMenuTrigger
            }"
            [ngClass]="{
              active: activeSubModule?.title == module.title,
              disabled: module.disabled
            }"
            (mouseover)="subMenuTrigger.openMenu()"
            routerLinkActive="active-link"
            (isActiveChange)="onRouterLinkActive($event, module)"
            [routerLinkActiveOptions]="{ exact: true }"
          >
            {{ module.title }}
          </li>
        </ng-container>
        <ng-container *ngIf="!module.moreOptions">
          <li
            class="mr-2 cursor-pointer max-health-primary-color"
            (click)="activeSubModule = module"
            [routerLink]="
              baseHref == module.tenentPath
                ? module.defaultPath
                : module.tenentPath + module.defaultPath
            "
            routerLinkActive="active-link"
            (isActiveChange)="onRouterLinkActive($event, module)"
            [routerLinkActiveOptions]="{ exact: true }"
            [ngClass]="{
              active: activeSubModule?.title == module.title,
              disabled: module.disabled
            }"
          >
            {{ module.title }}
          </li>
        </ng-container>
      </ng-container>
    </ul>

    <mat-menu #menu="matMenu" class="sub-header-menu">
      <ng-template
        matMenuContent
        let-aliasMenuItems="module.childrens"
        let-tenentPath="module.tenentPath"
        let-module="module"
        let-subMenuTrigger="subMenuTrigger"
      >
        <div
          class="flex flex-wrap max-width"
          [ngClass]="{ 'min-width': module?.childrens?.length <= 4 }"
        >
          <ng-container *ngFor="let menuItem of aliasMenuItems">
            <ng-container *ngIf="menuItem.childrens?.length > 0">
              <button
                [disabled]="menuItem.disabled"
                mat-menu-item
                class="w-full"
              >
                <maxhealth-sub-nested-menu
                  #nestedMenu
                  [module]="module"
                  [menu]="menuItem"
                  [tenentPath]="menuItem.tenentPath"
                  [subMenuTrigger]="subMenuTrigger"
                  [baseHref]="baseHref"
                  [onPageRouterLinkActive]="onPageRouterLinkActive"
                ></maxhealth-sub-nested-menu>
              </button>
            </ng-container>
            <ng-container
              *ngIf="menuItem.childrens?.length == 0 || !menuItem.childrens"
            >
              <button
                [disabled]="menuItem.disabled"
                mat-button
                class="max-health-primary-color w-1/3"
                [ngClass]="{
                  'w-1/3': aliasMenuItems.length > 8,
                  'w-1/2': aliasMenuItems.length <= 8,
                  'w-full': aliasMenuItems.length <= 4
                }"
                (click)="activeSubModule = module"
                [routerLink]="
                  baseHref == tenentPath
                    ? menuItem.defaultPath
                    : tenentPath + menuItem.defaultPath
                "
                disableRipple="true"
                routerLinkActive="active-link"
                (isActiveChange)="onPageRouterLinkActive($event, menuItem)"
                [routerLinkActiveOptions]="{ exact: true }"
              >
                {{ menuItem.title }}
              </button>
            </ng-container>
          </ng-container>
        </div>
      </ng-template>
    </mat-menu>
  </div>
</div>
